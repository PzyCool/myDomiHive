<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messages - DomiHive</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/CSS/messages-content.css">
</head>
<body>
    <!-- Messages Content -->
    <div class="messages-content">
        <!-- Page Header -->
        <div class="messages-header">
            <div class="header-content">
                <h1>
                    <i class="fas fa-comments"></i>
                    Messages
                </h1>
                <p>Communicate with property managers, tenants, and support</p>
            </div>
            <div class="header-actions">
                <button class="btn-primary" onclick="startNewConversation()">
                    <i class="fas fa-plus"></i>
                    New Message
                </button>
            </div>
        </div>

        <!-- Main Messages Layout -->
        <div class="messages-layout">
            <!-- Left Sidebar - Conversations List -->
            <div class="conversations-sidebar">
                <!-- Search and Filters -->
                <div class="sidebar-header">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="messageSearch" placeholder="Search messages...">
                    </div>
                    <div class="filter-options">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="unread">Unread</button>
                        <button class="filter-btn" data-filter="starred">Starred</button>
                    </div>
                </div>

                <!-- Conversation Categories -->
                <div class="conversation-categories">
                    <div class="category-item active" data-category="all">
                        <i class="fas fa-inbox"></i>
                        <span>All Messages</span>
                        <span class="count">12</span>
                    </div>
                    <div class="category-item" data-category="property">
                        <i class="fas fa-home"></i>
                        <span>Property</span>
                        <span class="count">8</span>
                    </div>
                    <div class="category-item" data-category="payment">
                        <i class="fas fa-credit-card"></i>
                        <span>Payments</span>
                        <span class="count">3</span>
                    </div>
                    <div class="category-item" data-category="maintenance">
                        <i class="fas fa-tools"></i>
                        <span>Maintenance</span>
                        <span class="count">5</span>
                    </div>
                    <div class="category-item" data-category="support">
                        <i class="fas fa-headset"></i>
                        <span>Support</span>
                        <span class="count">2</span>
                    </div>
                </div>

                <!-- Conversations List -->
                <div class="conversations-list">
                    <!-- Conversation Item 1 -->
                    <div class="conversation-item active" data-conversation="conv_1">
                        <div class="conversation-avatar">
                            <div class="avatar-placeholder">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <div class="status-indicator online"></div>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h4>Sarah Johnson - Ikoyi Apartments</h4>
                                <span class="message-time">2 min ago</span>
                            </div>
                            <p class="message-preview">Hi! Just wanted to follow up on the maintenance request for the kitchen plumbing...</p>
                            <div class="conversation-tags">
                                <span class="tag maintenance">Maintenance</span>
                                <span class="tag urgent">Urgent</span>
                            </div>
                        </div>
                        <div class="conversation-meta">
                            <div class="unread-count">3</div>
                            <button class="star-btn" onclick="toggleStar(this)">
                                <i class="far fa-star"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Conversation Item 2 -->
                    <div class="conversation-item" data-conversation="conv_2">
                        <div class="conversation-avatar">
                            <div class="avatar-placeholder">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="status-indicator away"></div>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h4>Mike Chen - VI Luxury Condo</h4>
                                <span class="message-time">1 hour ago</span>
                            </div>
                            <p class="message-preview">Thanks for confirming my payment. When will the receipt be available?</p>
                            <div class="conversation-tags">
                                <span class="tag payment">Payment</span>
                            </div>
                        </div>
                        <div class="conversation-meta">
                            <div class="unread-count">0</div>
                            <button class="star-btn starred" onclick="toggleStar(this)">
                                <i class="fas fa-star"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Conversation Item 3 -->
                    <div class="conversation-item" data-conversation="conv_3">
                        <div class="conversation-avatar">
                            <div class="avatar-placeholder">
                                <i class="fas fa-headset"></i>
                            </div>
                            <div class="status-indicator online"></div>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h4>DomiHive Support</h4>
                                <span class="message-time">3 hours ago</span>
                            </div>
                            <p class="message-preview">Your account verification has been completed successfully...</p>
                            <div class="conversation-tags">
                                <span class="tag support">Support</span>
                            </div>
                        </div>
                        <div class="conversation-meta">
                            <div class="unread-count">1</div>
                            <button class="star-btn" onclick="toggleStar(this)">
                                <i class="far fa-star"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Conversation Item 4 -->
                    <div class="conversation-item" data-conversation="conv_4">
                        <div class="conversation-avatar">
                            <div class="avatar-placeholder">
                                <i class="fas fa-tools"></i>
                            </div>
                            <div class="status-indicator offline"></div>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h4>Elite Maintenance Services</h4>
                                <span class="message-time">Yesterday</span>
                            </div>
                            <p class="message-preview">We've scheduled the AC repair for tomorrow at 2 PM. Please confirm if this works...</p>
                            <div class="conversation-tags">
                                <span class="tag maintenance">Maintenance</span>
                                <span class="tag scheduled">Scheduled</span>
                            </div>
                        </div>
                        <div class="conversation-meta">
                            <div class="unread-count">0</div>
                            <button class="star-btn" onclick="toggleStar(this)">
                                <i class="far fa-star"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Conversation Item 5 -->
                    <div class="conversation-item" data-conversation="conv_5">
                        <div class="conversation-avatar">
                            <div class="avatar-placeholder">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <div class="status-indicator online"></div>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h4>Security Department</h4>
                                <span class="message-time">2 days ago</span>
                            </div>
                            <p class="message-preview">Security system maintenance scheduled for this weekend. Brief downtime expected...</p>
                            <div class="conversation-tags">
                                <span class="tag maintenance">Maintenance</span>
                                <span class="tag scheduled">Scheduled</span>
                            </div>
                        </div>
                        <div class="conversation-meta">
                            <div class="unread-count">0</div>
                            <button class="star-btn" onclick="toggleStar(this)">
                                <i class="far fa-star"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Main Content - Active Conversation -->
            <div class="conversation-main">
                <!-- No Conversation Selected State -->
                <div class="no-conversation" id="noConversation">
                    <div class="empty-state">
                        <i class="fas fa-comments"></i>
                        <h3>Select a conversation</h3>
                        <p>Choose a conversation from the list to start messaging, or start a new conversation.</p>
                        <button class="btn-primary" onclick="startNewConversation()">
                            <i class="fas fa-plus"></i>
                            Start New Conversation
                        </button>
                    </div>
                </div>

                <!-- Active Conversation View (Hidden by default) -->
                <div class="active-conversation" id="activeConversation" style="display: none;">
                    <!-- Conversation Header -->
                    <div class="conversation-header-main">
                        <div class="conversation-partner">
                            <div class="partner-avatar">
                                <div class="avatar-placeholder">
                                    <i class="fas fa-user-tie"></i>
                                </div>
                                <div class="status-indicator online"></div>
                            </div>
                            <div class="partner-info">
                                <h3 id="conversationPartnerName">Sarah Johnson</h3>
                                <p id="conversationPartnerRole">Property Manager - Ikoyi Apartments</p>
                            </div>
                        </div>
                        <div class="conversation-actions">
                            <button class="action-btn" title="Voice Call">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="action-btn" title="Video Call">
                                <i class="fas fa-video"></i>
                            </button>
                            <button class="action-btn" title="Search Conversation">
                                <i class="fas fa-search"></i>
                            </button>
                            <button class="action-btn" title="More Options">
                                <i class="fas fa-ellipsis-v"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Messages Container -->
                    <div class="messages-container" id="messagesContainer">
                        <!-- Message Date Separator -->
                        <div class="message-date-separator">
                            <span>Today</span>
                        </div>

                        <!-- Received Message -->
                        <div class="message received">
                            <div class="message-avatar">
                                <div class="avatar-placeholder">
                                    <i class="fas fa-user-tie"></i>
                                </div>
                            </div>
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Hello! I wanted to follow up on the maintenance request you submitted for the kitchen plumbing. Our team has reviewed it and we've scheduled a technician to visit tomorrow between 2-4 PM.</p>
                                    <div class="message-time">
                                        <i class="fas fa-check-double read"></i>
                                        10:30 AM
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sent Message -->
                        <div class="message sent">
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Thank you for the update! Tomorrow between 2-4 PM works perfectly. I'll make sure to be available then.</p>
                                    <div class="message-time">
                                        10:32 AM
                                    </div>
                                </div>
                            </div>
                            <div class="message-avatar">
                                <div class="avatar-placeholder">
                                    <i class="fas fa-user"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Received Message with Attachment -->
                        <div class="message received">
                            <div class="message-avatar">
                                <div class="avatar-placeholder">
                                    <i class="fas fa-user-tie"></i>
                                </div>
                            </div>
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Great! I'm also sending you the technician's details and the work order for your reference.</p>
                                    <!-- File Attachment -->
                                    <div class="message-attachment">
                                        <div class="attachment-icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </div>
                                        <div class="attachment-info">
                                            <div class="attachment-name">Work_Order_Plumbing_001.pdf</div>
                                            <div class="attachment-size">2.4 MB</div>
                                        </div>
                                        <button class="attachment-download" onclick="downloadAttachment('Work_Order_Plumbing_001.pdf')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                    <div class="message-time">
                                        <i class="fas fa-check-double read"></i>
                                        10:35 AM
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sent Message Response -->
                        <div class="message sent">
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Thanks for sending the details. I'll review them now and make sure everything is ready for tomorrow.</p>
                                    <div class="message-time">
                                        10:38 AM
                                    </div>
                                </div>
                            </div>
                            <div class="message-avatar">
                                <div class="avatar-placeholder">
                                    <i class="fas fa-user"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Message Composer -->
                    <div class="message-composer">
                        <!-- Composer Toolbar -->
                        <div class="composer-toolbar">
                            <button class="tool-btn" onclick="toggleAttachmentMenu()" title="Attach File">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button class="tool-btn" onclick="insertQuickTemplate()" title="Templates">
                                <i class="fas fa-sticky-note"></i>
                            </button>
                            <button class="tool-btn" onclick="scheduleMessage()" title="Schedule">
                                <i class="fas fa-clock"></i>
                            </button>
                        </div>

                        <!-- Attachment Menu (Hidden by default) -->
                        <div class="attachment-menu" id="attachmentMenu" style="display: none;">
                            <div class="attachment-options">
                                <button class="attachment-option" onclick="attachFile('image')">
                                    <i class="fas fa-image"></i>
                                    <span>Photo</span>
                                </button>
                                <button class="attachment-option" onclick="attachFile('document')">
                                    <i class="fas fa-file"></i>
                                    <span>Document</span>
                                </button>
                                <button class="attachment-option" onclick="attachFile('payment')">
                                    <i class="fas fa-receipt"></i>
                                    <span>Payment Proof</span>
                                </button>
                                <button class="attachment-option" onclick="attachFile('maintenance')">
                                    <i class="fas fa-tools"></i>
                                    <span>Maintenance Photo</span>
                                </button>
                            </div>
                        </div>

                        <!-- Message Input -->
                        <div class="message-input-container">
                            <textarea 
                                id="messageInput" 
                                placeholder="Type your message... (Press Enter to send, Shift+Enter for new line)" 
                                rows="1"
                                onkeydown="handleMessageInput(event)"
                            ></textarea>
                            <button class="send-btn" onclick="sendMessage()" id="sendButton" disabled>
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>

                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <button class="quick-action-btn" onclick="quickAction('payment')">
                                <i class="fas fa-credit-card"></i>
                                Payment Query
                            </button>
                            <button class="quick-action-btn" onclick="quickAction('maintenance')">
                                <i class="fas fa-tools"></i>
                                Maintenance Request
                            </button>
                            <button class="quick-action-btn" onclick="quickAction('document')">
                                <i class="fas fa-file-contract"></i>
                                Document Request
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- New Conversation Modal -->
        <div class="modal" id="newConversationModal">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h3>Start New Conversation</h3>
                    <button class="close-modal" onclick="closeNewConversationModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="new-conversation-form">
                        <div class="form-group">
                            <label for="recipientSelect">Select Recipient</label>
                            <select id="recipientSelect">
                                <option value="">Choose a contact...</option>
                                <option value="manager_1">Sarah Johnson (Property Manager)</option>
                                <option value="support_1">DomiHive Support</option>
                                <option value="maintenance_1">Elite Maintenance Services</option>
                                <option value="security_1">Security Department</option>
                                <option value="new_contact">Add New Contact</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="conversationProperty">Related Property</label>
                            <select id="conversationProperty">
                                <option value="">Select property (optional)</option>
                                <option value="prop_1">Ikoyi Luxury Apartments</option>
                                <option value="prop_2">Victoria Island Condo</option>
                                <option value="prop_3">Lekki Phase 1 Penthouse</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="conversationSubject">Subject</label>
                            <input type="text" id="conversationSubject" placeholder="What is this conversation about?">
                        </div>
                        
                        <div class="form-group">
                            <label for="conversationCategory">Category</label>
                            <select id="conversationCategory">
                                <option value="general">General Inquiry</option>
                                <option value="payment">Payment Related</option>
                                <option value="maintenance">Maintenance Request</option>
                                <option value="document">Document Request</option>
                                <option value="emergency">Emergency</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="initialMessage">Initial Message</label>
                            <textarea id="initialMessage" rows="4" placeholder="Type your message..."></textarea>
                        </div>

                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="urgentMessage">
                                <span class="checkmark"></span>
                                Mark as urgent
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn-secondary" onclick="closeNewConversationModal()">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="createNewConversation()">
                        <i class="fas fa-paper-plane"></i>
                        Start Conversation
                    </button>
                </div>
            </div>
        </div>

        <!-- Attachment Preview Modal -->
        <div class="modal" id="attachmentPreviewModal">
            <div class="modal-overlay"></div>
            <div class="modal-container large-modal">
                <div class="modal-header">
                    <h3>Attachment Preview</h3>
                    <button class="close-modal" onclick="closeAttachmentPreview()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="attachment-preview" id="attachmentPreviewContent">
                        <!-- Attachment preview will be loaded here -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn-secondary" onclick="closeAttachmentPreview()">
                        Close
                    </button>
                    <button class="btn-primary" onclick="downloadCurrentAttachment()">
                        <i class="fas fa-download"></i>
                        Download
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="/JAVASCRIPT/messages-content.js"></script>
</body>
</html>